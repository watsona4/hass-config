
# Loads default set of integrations. Do not remove.
default_config:

homeassistant:
  external_url: "https://hass.battenkillwoodworks.com"
  internal_url: "http://frigate.home.arpa:8123"
  auth_providers:
    - type: homeassistant
    - type: trusted_networks
      trusted_networks:
        - 10.10.10.0/24
  auth_mfa_modules:
    - type: totp
  packages: !include_dir_named packages

http:
  use_x_forwarded_for: true
  trusted_proxies:
    - 10.10.10.1
    - 127.0.0.1
    - 2603:7080:8a00:5b00::/64
  ip_ban_enabled: true
  login_attempts_threshold: 5

logger:
  default: warning
  logs:
    pyatv: critical
    homeassistant.components.apple_tv: critical
    homeassistant.components.switchbot.cover: critical
    homeassistant.components.switchbot.coordinator: critical
    homeassistant.components.switchbot: critical
    homeassistant.components.bluetooth.passive_update_coordinator: critical
    homeassistant.components.bluetooth.active_update_coordinator: critical
    homeassistant.components.bluetooth.manager: critical
    homeassistant.components.recorder: info
    sqlalchemy.engine.Engine: warning
    homeassistant.core: info
    homeassistant.helpers.event: info
    homeassistant.components.rest_command: info
  filters:
    homeassistant.components.mqtt.entity:
      - "deprecated option `object_id`"

recorder:
  db_url: "mysql://ha:ufEOx3ZH8NBwD2HEfnJquHbk@127.0.0.1/homeassistant?charset=utf8mb4"
  purge_keep_days: 30
  auto_purge: true
  auto_repack: true
  commit_interval: 10
  exclude:
    domains:
      - updater
      - sun
    event_types:
      - strava_activities_update
      - strava_activity_detail_update
      - zwift_profile_update
      - zwift_world_update
      - zwift_activity_update
      - zwift_fit_parsed
    entities:
      - device_tracker.rv_gps
      - sensor.strava_activities_raw
      - sensor.zwift_activity_data
      - automation.rv_gps_statestream_merged_json
      - script.single_window
      - script.window_position
      - sensor.rv_bridge_location_raw
    entity_globs:
      - sensor.*_rssi
      - sensor.*_linkquality
      - sensor.*_uptime
      - sensor.*_last_seen
      - sensor.*_signal_strength
      - sensor.*_weight_projection
      - sensor.*_bodyfat_projection
      - sensor.*_weight_events
      - sensor.*_bodyfat_events
      - sensor.google_pollen_*
      - sensor.openmeteo_*
      - sensor.pollen_species_list_*_today
      - sensor.pollen_forecast_*_day_*
      - sensor.*_lhm_*
      - binary_sensor.webcam_running

pyscript:
  allow_all_imports: true
  hass_is_global: true

frontend:
  themes: !include_dir_merge_named themes
  extra_module_url:
    - /local/hass-bha-icons.js
    - /local/community/lovelace-card-mod/card-mod.js

lovelace:
  mode: yaml
  resources:
    - url: /local/community/lovelace-mushroom/mushroom.js
      type: module
    - url: /local/community/lovelace-auto-entities/auto-entities.js
      type: module
    - url: /local/community/decluttering-card/decluttering-card.js
      type: module
    - url: /local/community/button-card/button-card.js
      type: module
    - url: /local/community/clock-weather-card/clock-weather-card.js
      type: module
    - url: /local/community/frigate-hass-card/frigate-hass-card.js
      type: module
    - url: /local/community/mini-graph-card/mini-graph-card-bundle.js
      type: module
    - url: /local/community/modern-circular-gauge/modern-circular-gauge.js
      type: module
    - url: /local/community/lovelace-hourly-weather/hourly-weather.js
      type: module
    - url: /local/community/apexcharts-card/apexcharts-card.js
      type: module
    - url: /local/community/config-template-card/config-template-card.js
      type: module
    - url: /local/community/lovelace-card-mod/card-mod.js
      type: module
    - url: /local/community/stack-in-card/stack-in-card.js
      type: module
    - url: /local/community/flex-table-card/flex-table-card.js
      type: module
    - url: /local/community/lovelace-state-switch/state-switch.js
      type: module
    - url: /local/community/advanced-camera-card/advanced-camera-card.js
      type: module
  dashboards:
    lovelace-health:
      mode: yaml
      title: "Health & Fitness"
      icon: mdi:heart-pulse
      show_in_sidebar: true
      filename: dashboards/health/dashboard.yaml
    lovelace-environment:
      mode: yaml
      title: Environment
      icon: mdi:leaf
      show_in_sidebar: true
      filename: dashboards/environment/dashboard.yaml
    lovelace-computers:
      mode: yaml
      title: Computers
      icon: mdi:server
      show_in_sidebar: true
      filename: dashboards/computers/dashboard.yaml
    lovelace-rv:
      mode: yaml
      title: RV
      icon: mdi:caravan
      show_in_sidebar: true
      filename: dashboards/rv/dashboard.yaml
    lovelace-security:
      mode: yaml
      title: Security
      icon: mdi:cctv
      show_in_sidebar: true
      filename: dashboards/security/dashboard.yaml
    lovelace-spaces:
      mode: yaml
      title: Spaces
      icon: mdi:floor-plan
      show_in_sidebar: true
      filename: dashboards/spaces/dashboard.yaml
    lovelace-systems:
      mode: yaml
      title: Systems
      icon: mdi:home-automation
      show_in_sidebar: true
      filename: dashboards/systems/dashboard.yaml

zone:
  - name: Home
    latitude: !secret home_latitude
    longitude: !secret home_longitude
    radius: 100
    icon: mdi:home

# Built-in YAML includes
automation: !include automations.yaml
script: !include scripts.yaml
scene: !include scenes.yaml

# Custom YAML entities
mqtt: !include includes/mqtt.yaml
template: !include_dir_merge_list includes/templates
notify: !include includes/notification_groups.yaml
climate: !include includes/climate.yaml
generic_hygrostat: !include includes/generic_hygrostat.yaml
binary_sensor: !include includes/binary_sensor.yaml
sensor: !include_dir_merge_list includes/sensors
utility_meter: !include includes/utility_meters.yaml
