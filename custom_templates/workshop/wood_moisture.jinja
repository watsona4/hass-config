{# # File: config/custom_templates/wood_moisture.jinja ## #}
{# Wood moisture content (MC %) for lumber or firewood #}

{% from 'helpers.jinja' import level_find %}

{% macro mode_pick(mode='firewood') -%}
  {%- set m = (mode|string|lower) -%}
  {{ 'lumber' if m in ['lumber','timber','woodwork'] else 'firewood' }}
{%- endmacro %}

{# Breakpoints by mode #}
{% set bps_lumber = [0, 6, 8, 12, 15, 19, 25] %}     {# interior use target ~6–8% #}
{% set bps_fire   = [0,10,15,20,25,35,50] %}         {# burnable ≤20% #}

{% set names = ["Over-Dry","Dry","Acceptable","Borderline","Wet","Very Wet","Green"] %}
{% set icons = ["mdi:water-off","mdi:water-check","mdi:water-check","mdi:water","mdi:water","mdi:water-alert","mdi:waves"] %}
{% set colors= ["#9ca3af","#22c55e","#22c55e","#eab308","#f59e0b","#ef4444","#7c3aed","disabled"] %}
{% set descs = [
  "Very low MC; expect movement/splitting risk.",
  "Dry—ready for use/burning.",
  "Acceptable for most uses.",
  "Borderline; acclimate longer.",
  "Wet; not suitable yet.",
  "Very wet; long dry time.",
  "Green wood."
] %}

{% macro level(mc_pct, mode='firewood') -%}
  {%- set bps = bps_lumber if mode_pick(mode) == 'lumber' else bps_fire -%}
  {{ level_find((mc_pct|float), bps) }}
{%- endmacro %}
{% macro name(mc_pct, mode='firewood') -%}{{ names[level(mc_pct,mode)|int-1] }}{%- endmacro %}
{% macro icon(mc_pct, mode='firewood') -%}{{ icons[level(mc_pct,mode)|int-1] }}{%- endmacro %}
{% macro color(mc_pct, mode='firewood') -%}{{ colors[level(mc_pct,mode)|int-1] }}{%- endmacro %}
{% macro desc(mc_pct, mode='firewood') -%}{{ descs[level(mc_pct,mode)|int-1] }}{%- endmacro %}
{% macro label(mc_pct, mode='firewood') -%}{{ name(mc_pct,mode) }} • {{ (mc_pct|float)|round(0) }}% MC{%- endmacro %}