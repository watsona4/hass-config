{# # File: config/custom_templates/humidity.jinja ## #}
{# Macros for Relative Humidity levels, names, icons, colors, and guidance #}

{% from 'macros.jinja' import level_find %}

{# Breakpoints for Relative Humidity levels, in percent (lower bounds of each band) #}
{# Bands: Extremely Dry, Very Dry, Dry, Low RH, Comfort, Moderately Humid, Humid, Very Humid, Oppressive #}
{% set bps = [0, 10, 20, 30, 40, 50, 60, 70, 80] %}

{# Names for RH levels #}
{% set names = [
    "Extremely Dry",
    "Very Dry",
    "Dry",
    "Low Humidity",
    "Comfort",
    "Moderately Humid",
    "Humid",
    "Very Humid",
    "Oppressive"
] %}

{# Short names for compact UIs #}
{% set shorts = ["Ext Dry", "Very Dry", "Dry", "Low RH", "Comfort", "Mod Humid", "Humid", "V Humid", "Oppress"] %}

{# Long names for descriptive titles #}
{% set longs = [
    "Extremely Dry Air",
    "Very Dry Air",
    "Dry Air",
    "Low Humidity",
    "Comfort Range",
    "Moderately Humid Air",
    "Humid Air",
    "Very Humid Air",
    "Oppressive Humidity"
] %}

{# Icons for RH levels #}
{% set icons = [
    "mdi:water-off",
    "mdi:water-outline",
    "mdi:water-percent",
    "mdi:water-check",
    "mdi:water",
    "mdi:water-percent",
    "mdi:water-alert",
    "mdi:weather-pouring",
    "mdi:waves"
] %}

{# Colors for RH levels: warm dry to cool wet #}
{% set colors = [
    "#a16207",
    "#d97706",
    "#f59e0b",
    "#84cc16",
    "#10b981",
    "#2dd4bf",
    "#60a5fa",
    "#3b82f6",
    "#7c3aed",
    "disabled"
] %}

{# Descriptions for each level #}
{% set descriptions = [
    "Extremely dry conditions, high static and skin irritation risk; consider a humidifier.",
    "Very dry; add moisture, especially for wood instruments or plants.",
    "Dry; many will notice dry skin and lips.",
    "Low humidity; still a bit dry for comfort.",
    "Comfort range for most homes and electronics.",
    "Slightly muggy; ventilate or dehumidify if needed.",
    "Humid; increase ventilation and consider dehumidification.",
    "Very humid; mold and dust mites thrive, dehumidify aggressively.",
    "Oppressive humidity; strong dehumidification and air conditioning recommended."
] %}

{# Unit normalization helper: returns percent for numeric inputs #}
{# unit may be '%' (default) or 'ratio'/'frac' for 0..1 inputs #}
{% macro to_pct(h, unit='%') -%}
    {%- set u = (unit|string|lower) -%}
    {%- if h is number -%}
        {%- if u in ['ratio', 'frac', 'fraction'] -%}
            {{ h * 100 }}
        {%- else -%}
            {{ h }}
        {%- endif -%}
    {%- else -%}
        {{ h }}
    {%- endif -%}
{%- endmacro %}

{# Wrappers for standard functions #}
{% macro level(h, unit='%') -%}
    {%- set v = to_pct(h, unit)|float -%}
    {%- set v = 0 if v < 0 else (100 if v > 100 else v) -%}
    {{ level_find(v, bps) }}
{%- endmacro %}

{# djlint:off #}
{% macro name(h, unit='%') %}{{ names[level(h, unit)|int - 1] }}{% endmacro %}
{% macro short(h, unit='%') %}{{ shorts[level(h, unit)|int - 1] }}{% endmacro %}
{% macro long(h, unit='%') %}{{ longs[level(h, unit)|int - 1] }}{% endmacro %}
{% macro icon(h, unit='%') %}{{ icons[level(h, unit)|int - 1] }}{% endmacro %}
{% macro desc(h, unit='%') %}{{ descriptions[level(h, unit)|int - 1] }}{% endmacro %}
{% macro color(h, unit='%') %}{{ colors[level(h, unit)|int - 1] }}{% endmacro %}
{# djlint:on #}
