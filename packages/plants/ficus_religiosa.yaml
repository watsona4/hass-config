###############################################################################
# Plant care package: Ficus religiosa (ficus religiosa)
# Generated by generate_plant_assets.py
###############################################################################
homeassistant:
  customize:
    plant.ficus_religiosa:
      friendly_name: "Ficus religiosa"

plant:
  ficus_religiosa:
    sensors:
      moisture: sensor.ficus_religiosa_moisture_routed
      temperature: sensor.ficus_religiosa_temperature_routed
      brightness: sensor.ficus_religiosa_illuminance_routed
      conductivity: sensor.ficus_religiosa_conductivity_routed

template:
  - sensor:
      - name: "Ficus religiosa Light Min Lux"
        unique_id: "ficus_religiosa_light_min_lux"
        state: "3500.0"
        unit_of_measurement: "lx"
      - name: "Ficus religiosa Light Max Lux"
        unique_id: "ficus_religiosa_light_max_lux"
        state: "95000.0"
        unit_of_measurement: "lx"
      - name: "Ficus religiosa Temp Min"
        unique_id: "ficus_religiosa_temp_min"
        state: "12.0"
        unit_of_measurement: "°C"
      - name: "Ficus religiosa Temp Max"
        unique_id: "ficus_religiosa_temp_max"
        state: "38.0"
        unit_of_measurement: "°C"
      - name: "Ficus religiosa Humidity Min"
        unique_id: "ficus_religiosa_humid_min"
        state: "30.0"
        unit_of_measurement: "%"
      - name: "Ficus religiosa Humidity Max"
        unique_id: "ficus_religiosa_humid_max"
        state: "85.0"
        unit_of_measurement: "%"
      - name: "Ficus religiosa Moisture Min"
        unique_id: "ficus_religiosa_moist_min"
        state: "20.0"
        unit_of_measurement: "%"
      - name: "Ficus religiosa Moisture Max"
        unique_id: "ficus_religiosa_moist_max"
        state: "65.0"
        unit_of_measurement: "%"
      - name: "Ficus religiosa EC Min"
        unique_id: "ficus_religiosa_ec_min"
        state: "30.0"
        unit_of_measurement: "µS/cm"
      - name: "Ficus religiosa EC Max"
        unique_id: "ficus_religiosa_ec_max"
        state: "2000.0"
        unit_of_measurement: "µS/cm"

  - binary_sensor:
      - name: "Ficus religiosa Temperature OK"
        unique_id: "ficus_religiosa_temp_ok"
        device_class: problem
        state: >-
          {% from 'units/base.jinja' import u_convert_entity %}
          {% set t = u_convert_entity('sensor.ficus_religiosa_temperature_routed', 'c')|float(none) %}
          {% set tmin = states('sensor.ficus_religiosa_temp_min')|float(none) %}
          {% set tmax = states('sensor.ficus_religiosa_temp_max')|float(none) %}
          {{ t is not none and tmin is not none and tmax is not none and (tmin <= t <= tmax) }}
      - name: "Ficus religiosa Light OK"
        unique_id: "ficus_religiosa_light_ok"
        device_class: problem
        state: >-
          {% set l = states('sensor.ficus_religiosa_illuminance_routed')|float(none) %}
          {% set lmin = states('sensor.ficus_religiosa_light_min_lux')|float(none) %}
          {% set lmax = states('sensor.ficus_religiosa_light_max_lux')|float(none) %}
          {{ l is not none and lmin is not none and lmax is not none and (lmin <= l <= lmax) }}
      - name: "Ficus religiosa Moisture OK"
        unique_id: "ficus_religiosa_moist_ok"
        device_class: problem
        state: >-
          {% set m = states('sensor.ficus_religiosa_moisture_routed')|float(none) %}
          {% set mmin = states('sensor.ficus_religiosa_moisture_min')|float(none) %}
          {% set mmax = states('sensor.ficus_religiosa_moisture_max')|float(none) %}
          {{ m is not none and mmin is not none and mmax is not none and (mmin <= m <= mmax) }}
      - name: "Ficus religiosa EC OK"
        unique_id: "ficus_religiosa_ec_ok"
        device_class: problem
        state: >-
          {% set e = states('sensor.ficus_religiosa_conductivity_routed')|float(none) %}
          {% set emin = states('sensor.ficus_religiosa_ec_min')|float(none) %}
          {% set emax = states('sensor.ficus_religiosa_ec_max')|float(none) %}
          {{ e is not none and emin is not none and emax is not none and (emin <= e <= emax) }}
      - name: "Ficus religiosa All OK"
        unique_id: "ficus_religiosa_all_ok"
        device_class: problem
        state: >-
          {{ is_state('binary_sensor.ficus_religiosa_temperature_ok','on')
             and is_state('binary_sensor.ficus_religiosa_light_ok','on')
             and is_state('binary_sensor.ficus_religiosa_moisture_ok','on')
             and is_state('binary_sensor.ficus_religiosa_ec_ok','on') }}

  - sensor:
      - name: "Ficus religiosa Care Notes"
        unique_id: "ficus_religiosa_care_notes"
        icon: mdi:leaf
        state: >-
          {% from 'units/base.jinja' import u_convert_value, u_convert_entity, u_humanize_value, u_humanize_entity %}
          {% set ns = namespace(out=[]) %}
          {% set t = u_convert_entity('sensor.ficus_religiosa_temperature_routed', 'c')|float(none) %}
          {% set l = states('sensor.ficus_religiosa_illuminance_routed')|float(none) %}
          {% set m = states('sensor.ficus_religiosa_moisture_routed')|float(none) %}
          {% set e = states('sensor.ficus_religiosa_conductivity_routed')|float(none) %}
          {% set tmin = states('sensor.ficus_religiosa_temp_min')|float(none) %}
          {% set tmax = states('sensor.ficus_religiosa_temp_max')|float(none) %}
          {% set tminf = u_humanize_value(u_convert_entity('sensor.ficus_religiosa_temp_min', 'f'), '°F') -%}
          {% set tmaxf = u_humanize_value(u_convert_entity('sensor.ficus_religiosa_temp_max', 'f'), '°F') -%}
          {% set lmin = states('sensor.ficus_religiosa_light_min_lux')|float(none) %}
          {% set lmax = states('sensor.ficus_religiosa_light_max_lux')|float(none) %}
          {% set mmin = states('sensor.ficus_religiosa_moisture_min')|float(none) %}
          {% set mmax = states('sensor.ficus_religiosa_moisture_max')|float(none) %}
          {% set emin = states('sensor.ficus_religiosa_ec_min')|float(none) %}
          {% set emax = states('sensor.ficus_religiosa_ec_max')|float(none) %}
          {% if t is not none and (t < tmin or t > tmax) %}
            {% if t < tmin %}
              {% set ns.out = ns.out + ['Warm environment to ' ~ u_humanize_value(tmin,'°C') ~ '–' ~ u_humanize_value(tmax,'°C') ~ ' (' ~ tminf ~ '–' ~ tmaxf ~ ').'] %}
            {% else %}
              {% set ns.out = ns.out + ['Cool environment to ' ~ u_humanize_value(tmin,'°C') ~ '–' ~ u_humanize_value(tmax,'°C') ~ ' (' ~ tminf ~ '–' ~ tmaxf ~ ').'] %}
            {% endif %}
          {% endif %}
          {% if l is not none and (l < lmin or l > lmax) %}
            {% if l < lmin %}
              {% set ns.out = ns.out + ['Increase light toward ' ~ u_humanize_value(lmin) ~ '–' ~ u_humanize_value(lmax,'lx') ~ '.'] %}
            {% else %}
              {% set ns.out = ns.out + ['Reduce direct light; target ' ~ u_humanize_value(lmin) ~ '–' ~ u_humanize_value(lmax,'lx') ~ ' .'] %}
            {% endif %}
          {% endif %}
          {% if m is not none and (m < mmin or m > mmax) %}
            {% if m < mmin %}
              {% set ns.out = ns.out + ['Water thoroughly; maintain soil moisture ' ~ u_humanize_value(mmin,'%') ~ '–' ~ u_humanize_value(mmax,'%') ~ '.'] %}
            {% else %}
              {% set ns.out = ns.out + ['Allow soil to dry slightly; keep ' ~ u_humanize_value(mmin,'%') ~ '–' ~ u_humanize_value(mmax,'%') ~ '.'] %}
            {% endif %}
          {% endif %}
          {% if e is not none and (e < emin or e > emax) %}
            {% if e < emin %}
              {% set ns.out = ns.out + ['Feed lightly; EC ' ~ u_humanize_value(emin) ~ '–' ~ u_humanize_value(emax) ~ ' µS/cm.'] %}
            {% else %}
              {% set ns.out = ns.out + ['Flush to reduce salts; resume gentle feeding.'] %}
            {% endif %}
          {% endif %}
          {{ (ns.out | join('\n')) if ns.out else 'Optimal. Maintain current care.' }}
        attributes:
          image: "http://pkb.resource.huahuacaocao.com/ZmljdXMgcmVsaWdpb3NhLmpwZw==?imageView2/1/w/%d/h/%d"
          alias: "ficus religiosa"
          origin: "Asia"
          production: "China"
          category: "Moraceae, Ficus"
          floral_language: ""
          blooming: "Flowering period March-April, fruit period May-June"
          color: "Flower color light yellow"
          size: "Diameter≥20cm，Height20-30m"
          soil: "Loose, fertile, and well-drained loam soil"
          sunlight: "Enjoy sunlight, resistant to half shade"
          watering: "Water thoroughly when soil surface is dry"
          fertilization: "Dilute fertilizers following instructions, apply once monthly in spring and autumn"
          pruning: "Remove old, diseased and dead leaves timely"

# ---------------- thresholds from CSV (edit freely) ----------------
# Light mmol: min=3200.0, max=13000.0
# Light lux:  min=3500.0,  max=95000.0
# Temp C:     min=12.0,       max=38.0
# Humidity %: min=30.0,      max=85.0
# Moisture%:  min=20.0,      max=65.0
# EC µS/cm:   min=30.0,         max=2000.0

