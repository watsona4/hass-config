###############################################################################
# Plant care package: Hedera helix (hedera helix)
# Generated by generate_plant_assets.py
###############################################################################
homeassistant:
  customize:
    plant.hedera_helix:
      friendly_name: "Hedera helix"

plant:
  hedera_helix:
    sensors:
      moisture: sensor.hedera_helix_moisture_routed
      temperature: sensor.hedera_helix_temperature_routed
      brightness: sensor.hedera_helix_illuminance_routed
      conductivity: sensor.hedera_helix_conductivity_routed

template:
  - sensor:
      - name: "Hedera helix Light Min Lux"
        unique_id: "hedera_helix_light_min_lux"
        state: "500.0"
        unit_of_measurement: "lx"
      - name: "Hedera helix Light Max Lux"
        unique_id: "hedera_helix_light_max_lux"
        state: "45000.0"
        unit_of_measurement: "lx"
      - name: "Hedera helix Temp Min"
        unique_id: "hedera_helix_temp_min"
        state: "10.0"
        unit_of_measurement: "°C"
      - name: "Hedera helix Temp Max"
        unique_id: "hedera_helix_temp_max"
        state: "35.0"
        unit_of_measurement: "°C"
      - name: "Hedera helix Humidity Min"
        unique_id: "hedera_helix_humid_min"
        state: "30.0"
        unit_of_measurement: "%"
      - name: "Hedera helix Humidity Max"
        unique_id: "hedera_helix_humid_max"
        state: "85.0"
        unit_of_measurement: "%"
      - name: "Hedera helix Moisture Min"
        unique_id: "hedera_helix_moist_min"
        state: "15.0"
        unit_of_measurement: "%"
      - name: "Hedera helix Moisture Max"
        unique_id: "hedera_helix_moist_max"
        state: "60.0"
        unit_of_measurement: "%"
      - name: "Hedera helix EC Min"
        unique_id: "hedera_helix_ec_min"
        state: "350.0"
        unit_of_measurement: "µS/cm"
      - name: "Hedera helix EC Max"
        unique_id: "hedera_helix_ec_max"
        state: "2000.0"
        unit_of_measurement: "µS/cm"

  - binary_sensor:
      - name: "Hedera helix Temperature OK"
        unique_id: "hedera_helix_temp_ok"
        device_class: problem
        state: >-
          {% from 'units/base.jinja' import u_convert_entity %}
          {% set t = u_convert_entity('sensor.hedera_helix_temperature_routed', 'c')|float(none) %}
          {% set tmin = states('sensor.hedera_helix_temp_min')|float(none) %}
          {% set tmax = states('sensor.hedera_helix_temp_max')|float(none) %}
          {{ t is not none and tmin is not none and tmax is not none and (tmin <= t <= tmax) }}
      - name: "Hedera helix Light OK"
        unique_id: "hedera_helix_light_ok"
        device_class: problem
        state: >-
          {% set l = states('sensor.hedera_helix_illuminance_routed')|float(none) %}
          {% set lmin = states('sensor.hedera_helix_light_min_lux')|float(none) %}
          {% set lmax = states('sensor.hedera_helix_light_max_lux')|float(none) %}
          {{ l is not none and lmin is not none and lmax is not none and (lmin <= l <= lmax) }}
      - name: "Hedera helix Moisture OK"
        unique_id: "hedera_helix_moist_ok"
        device_class: problem
        state: >-
          {% set m = states('sensor.hedera_helix_moisture_routed')|float(none) %}
          {% set mmin = states('sensor.hedera_helix_moisture_min')|float(none) %}
          {% set mmax = states('sensor.hedera_helix_moisture_max')|float(none) %}
          {{ m is not none and mmin is not none and mmax is not none and (mmin <= m <= mmax) }}
      - name: "Hedera helix EC OK"
        unique_id: "hedera_helix_ec_ok"
        device_class: problem
        state: >-
          {% set e = states('sensor.hedera_helix_conductivity_routed')|float(none) %}
          {% set emin = states('sensor.hedera_helix_ec_min')|float(none) %}
          {% set emax = states('sensor.hedera_helix_ec_max')|float(none) %}
          {{ e is not none and emin is not none and emax is not none and (emin <= e <= emax) }}
      - name: "Hedera helix All OK"
        unique_id: "hedera_helix_all_ok"
        device_class: problem
        state: >-
          {{ is_state('binary_sensor.hedera_helix_temperature_ok','on')
             and is_state('binary_sensor.hedera_helix_light_ok','on')
             and is_state('binary_sensor.hedera_helix_moisture_ok','on')
             and is_state('binary_sensor.hedera_helix_ec_ok','on') }}

  - sensor:
      - name: "Hedera helix Care Notes"
        unique_id: "hedera_helix_care_notes"
        icon: mdi:leaf
        state: >-
          {% from 'units/base.jinja' import u_convert_value, u_convert_entity, u_humanize_value, u_humanize_entity %}
          {% set ns = namespace(out=[]) %}
          {% set t = u_convert_entity('sensor.hedera_helix_temperature_routed', 'c')|float(none) %}
          {% set l = states('sensor.hedera_helix_illuminance_routed')|float(none) %}
          {% set m = states('sensor.hedera_helix_moisture_routed')|float(none) %}
          {% set e = states('sensor.hedera_helix_conductivity_routed')|float(none) %}
          {% set tmin = states('sensor.hedera_helix_temp_min')|float(none) %}
          {% set tmax = states('sensor.hedera_helix_temp_max')|float(none) %}
          {% set tminf = u_humanize_value(u_convert_entity('sensor.hedera_helix_temp_min', 'f'), '°F') -%}
          {% set tmaxf = u_humanize_value(u_convert_entity('sensor.hedera_helix_temp_max', 'f'), '°F') -%}
          {% set lmin = states('sensor.hedera_helix_light_min_lux')|float(none) %}
          {% set lmax = states('sensor.hedera_helix_light_max_lux')|float(none) %}
          {% set mmin = states('sensor.hedera_helix_moisture_min')|float(none) %}
          {% set mmax = states('sensor.hedera_helix_moisture_max')|float(none) %}
          {% set emin = states('sensor.hedera_helix_ec_min')|float(none) %}
          {% set emax = states('sensor.hedera_helix_ec_max')|float(none) %}
          {% if t is not none and (t < tmin or t > tmax) %}
            {% if t < tmin %}
              {% set ns.out = ns.out + ['Warm environment to ' ~ u_humanize_value(tmin,'°C') ~ '–' ~ u_humanize_value(tmax,'°C') ~ ' (' ~ tminf ~ '–' ~ tmaxf ~ ').'] %}
            {% else %}
              {% set ns.out = ns.out + ['Cool environment to ' ~ u_humanize_value(tmin,'°C') ~ '–' ~ u_humanize_value(tmax,'°C') ~ ' (' ~ tminf ~ '–' ~ tmaxf ~ ').'] %}
            {% endif %}
          {% endif %}
          {% if l is not none and (l < lmin or l > lmax) %}
            {% if l < lmin %}
              {% set ns.out = ns.out + ['Increase light toward ' ~ u_humanize_value(lmin) ~ '–' ~ u_humanize_value(lmax,'lx') ~ '.'] %}
            {% else %}
              {% set ns.out = ns.out + ['Reduce direct light; target ' ~ u_humanize_value(lmin) ~ '–' ~ u_humanize_value(lmax,'lx') ~ ' .'] %}
            {% endif %}
          {% endif %}
          {% if m is not none and (m < mmin or m > mmax) %}
            {% if m < mmin %}
              {% set ns.out = ns.out + ['Water thoroughly; maintain soil moisture ' ~ u_humanize_value(mmin,'%') ~ '–' ~ u_humanize_value(mmax,'%') ~ '.'] %}
            {% else %}
              {% set ns.out = ns.out + ['Allow soil to dry slightly; keep ' ~ u_humanize_value(mmin,'%') ~ '–' ~ u_humanize_value(mmax,'%') ~ '.'] %}
            {% endif %}
          {% endif %}
          {% if e is not none and (e < emin or e > emax) %}
            {% if e < emin %}
              {% set ns.out = ns.out + ['Feed lightly; EC ' ~ u_humanize_value(emin) ~ '–' ~ u_humanize_value(emax) ~ ' µS/cm.'] %}
            {% else %}
              {% set ns.out = ns.out + ['Flush to reduce salts; resume gentle feeding.'] %}
            {% endif %}
          {% endif %}
          {{ (ns.out | join('\n')) if ns.out else 'Optimal. Maintain current care.' }}
        attributes:
          image: "http://pkb.resource.huahuacaocao.com/aGVkZXJhIGhlbGl4LmpwZw==?imageView2/1/w/%d/h/%d"
          alias: "hedera helix"
          origin: "China"
          production: "China"
          category: "Araliaceae, Hedera"
          floral_language: |-
            Hedera helix
            Floriography: tenacious, vigorous, young
            Hedera helix is a genus of 12–15 species of evergreen climbing or ground-creeping woody plants in the family Araliaceae, have aerial roots to absorb moisture and nutrition from the air. Beautiful symmetric leaves. Can be placed in the living room, on desks, or for hanging in pots. 
            Hedera helix tolerates shade, suitable under scattered light in summer and 3-4 hours sunlight in winter. Blooms sometimes in September to November with pale yellow or green flowers.
          blooming: "Foliage plants, sometimes flowers in September-November, light yellow or light green flowers"
          color: "Leaf color green"
          size: "Diameter ≥ 10 cm, height ≥ 10 cm"
          soil: "Peat or soil with specific nutrients"
          sunlight: "Resistant to shade plant, put in places with scattered light in summer, in winter may take 3-4h sunlight"
          watering: "Likes wet environments, water thoroughly when soil is dry, rub leaves with water in summer"
          fertilization: "Dilute fertilizers following instructions, apply 1-2 times monthly in the growing season, stop in winter"
          pruning: "Remove dead leaves timely"

# ---------------- thresholds from CSV (edit freely) ----------------
# Light mmol: min=1400.0, max=3500.0
# Light lux:  min=500.0,  max=45000.0
# Temp C:     min=10.0,       max=35.0
# Humidity %: min=30.0,      max=85.0
# Moisture%:  min=15.0,      max=60.0
# EC µS/cm:   min=350.0,         max=2000.0

