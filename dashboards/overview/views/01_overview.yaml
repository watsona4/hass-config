# File: dashboards/overview/views/01_overview.yaml
# Description: Overview dashboard main view configuration

title: Home
max_columns: 2
sections:

  # Overall Overview
  - type: grid
    cards:

      # Climate and Quick Setpoints
      - type: custom:decluttering-card
        template: title_card
        variables:
          - title: Climate
          - subtitle: Downstairs / Upstairs · Quick Setpoints

      # Climate Cards
      - type: horizontal-stack
        cards:
          - type: custom:decluttering-card
            template: climate_card
            variables:
              - entity: climate.downstairs_thermostat
              - name: Downstairs
          - type: custom:decluttering-card
            template: climate_card
            variables:
              - entity: climate.upstairs_thermostat
              - name: Upstairs
      
      # Network Status
      - type: horizontal-stack
        cards:
          - type: custom:decluttering-card
            template: template_card
            variables:
              - entity: sensor.netprobe_download
              - name: Download
              - app: download
              - layout: vertical
              - multiline_secondary: true
          - type: custom:decluttering-card
            template: template_card
            variables:
              - entity: sensor.netprobe_upload
              - name: Upload
              - app: upload
              - layout: vertical
              - multiline_secondary: true
          - type: custom:decluttering-card
            template: template_card
            variables:
              - entity: sensor.netprobe_latency_icmp
              - name: Latency
              - app: latency
              - layout: vertical
              - multiline_secondary: true

      # Utility Usage
      - type: horizontal-stack
        cards:
          - type: custom:decluttering-card
            template: template_card
            variables:
              - entity: sensor.electric_daily
              - app: daily
              - layout: vertical
              - multiline_secondary: true
              - options: project_daily=true
              - tap_action:
                  action: navigate
                  navigation_path: /energy
              - icon_tap_action:
                  action: more-info
          - type: custom:decluttering-card
            template: template_card
            variables:
              - entity: sensor.water_daily
              - app: daily
              - layout: vertical
              - multiline_secondary: true
              - options: project_daily=true
              - tap_action:
                  action: navigate
                  navigation_path: /energy
              - icon_tap_action:
                  action: more-info
          - type: custom:decluttering-card
            template: template_card
            variables:
              - entity: sensor.gas_daily
              - app: daily
              - layout: vertical
              - multiline_secondary: true
              - options: project_daily=true
              - tap_action:
                  action: navigate
                  navigation_path: /energy
              - icon_tap_action:
                  action: more-info

  # Outside Weather and Stats
  - type: grid
    cards:

      # Outside Title
      - type: custom:decluttering-card
        template: title_card
        variables:
          - title: Outside
          - subtitle: Temperature · Humidity · Other Stats

      # Temperature and Humidity
      - type: horizontal-stack
        cards:
          - type: custom:decluttering-card
            template: template_card
            variables:
              - entity: sensor.outside_temperature_state
              - name: Outside Temp
              - app: ambient
          - type: custom:decluttering-card
            template: template_card
            variables:
              - entity: sensor.outside_humidity_state
              - name: Outside Humidity
              - app: outdoor

      # Sunlight and UV Index
      - type: horizontal-stack
        cards:
          - type: custom:decluttering-card
            template: template_card
            variables:
              - entity: sensor.light_sensor_illuminance
              - name: Illuminance
              - app: outdoor
          - type: custom:decluttering-card
            template: template_card
            variables:
              - entity: sensor.openmeteo_nearby_uv_index
              - name: UV Index
              - app: uv_index
              - options: uom=

      # Wind and Precipitation
      - type: horizontal-stack
        cards:
          - type: custom:decluttering-card
            template: template_card
            variables:
              - entity: sensor.openmeteo_nearby_wind_speed
              - options: >-
                  direction=sensor.openmeteo_nearby_wind_direction;
                  gusts=sensor.openmeteo_nearby_wind_gust
          - type: custom:decluttering-card
            template: template_card
            variables:
              - entity: sensor.openmeteo_nearby_today_precip_sum
              - options: prob=sensor.openmeteo_nearby_today_precip_prob_max

      # Air Quality and Dew Point
      - type: horizontal-stack
        cards:
          - type: custom:decluttering-card
            template: template_card
            variables:
              - entity: sensor.waqi_nearby_aqi
              - name: Air Quality Index
          - type: custom:decluttering-card
            template: template_card
            variables:
              - entity: sensor.openmeteo_nearby_dew_point
              - name: Dew Point
              - app: dew_point

  # Status - Lights, Doors, Smoke/CO
  - type: grid
    cards:

      # Status Title
      - type: custom:mushroom-title-card
        title: Status
        subtitle: Lights On · Doors & Windows Open · Smoke/CO Alerts

      # Smoke and CO Alerts
      - type: custom:auto-entities
        show_empty: false
        card:
          type: grid
          columns: 2
          square: false
        card_param: cards
        filter:
          include:
            - entity_id: binary_sensor.nest_protect_*_smoke_status
              state: 'on'
              options:
                type: custom:mushroom-template-card
                entity: this.entity_id
                icon: mdi:fire-alert
                icon_color: red
                primary: "{{ area_name(entity) }}"
                tap_action:
                  action: more-info
            - entity_id: binary_sensor.nest_protect_*_co_status
              state: 'on'
              options:
                type: custom:mushroom-template-card
                entity: this.entity_id
                icon: mdi:molecule-co
                icon_color: red
                primary: "{{ area_name(entity) }}"
                tap_action:
                  action: more-info
          exclude: []

      # Lights On
      - type: custom:auto-entities
        show_empty: false
        card:
          type: grid
          columns: 2
          square: false
        card_param: cards
        filter:
          include:
            - domain: light
              state: 'on'
              options:
                type: custom:mushroom-light-card
                tap_action:
                  action: more-info
          exclude:
            - entity_id: /^.*\.browser_mod_/
            - entity_id: light.ratgdov25i_f6128e_light

      # Doors and Windows Open
      - type: custom:auto-entities
        show_empty: false
        card:
          type: grid
          columns: 2
          square: false
        card_param: cards
        filter:
          include:
            - domain: binary_sensor
              attributes:
                device_class: door
              state: 'on'
              options:
                type: custom:mushroom-template-card
                entity: this.entity_id
                primary: "{{ area_name(entity) }}"
                icon: mdi:door-open
                icon_color: amber
                tap_action:
                  action: more-info
            - domain: binary_sensor
              attributes:
                device_class: window
              state: 'on'
              options:
                type: custom:mushroom-template-card
                entity: this.entity_id
                primary: "{{ area_name(entity) }}"
                icon: mdi:window-open
                icon_color: amber
                tap_action:
                  action: more-info
          exclude: []

  # Unavailable Devices
  - type: grid
    cards:

      # Unavailable Title
      - type: custom:mushroom-title-card
        title: Unavailable Devices
        subtitle: Impacted Devices · Count of Affected Entities

      # Unavailable Devices Cards
      - type: custom:auto-entities
        show_empty: false
        card:
          type: grid
          columns: 2
          square: false
        card_param: cards
        filter:
          template: "{% from 'macros/unavailable_devices.jinja' import generate %}{{ generate() }}"
          exclude:
            - device: Dishwasher
            - device: Shop Lights
            - device: Living Room Lights
            - device: Dining Room Lights
            - device: Eleanor Presence
            - device: Kids Bathroom Presence
            - domain: person
            - domain: weather
            - entity_id: /^.*\..*_ap$/
            - entity_id: /^.*\..*_co$/
            - entity_id: /^.*\..*_no2$/
            - entity_id: /^.*\..*_pm10$/
            - entity_id: /^.*\..*_so2$/
            - entity_id: /^.*\.browser_mod_/
            - entity_id: /^sensor\.double_take_/
            - entity_id: binary_sensor.remote_ui
            - integration: dlna_dmr
            - integration: ibeacon
            - integration: mqtt
              device: DESKTOP-BQ063IG
            - integration: mqtt
              device: /[Ff]rigate/
            - integration: mqtt
              device: LAPTOP-OO58T6KN
            - integration: mqtt
              device: /[Oo]pnsense/
            - integration: smartthings
            - integration: tuya
        sort:
          method: name

  # Cameras and Pop-ups
  - type: grid
    column_span: 2
    square: false
    cards:

      # Cameras Title
      - type: custom:mushroom-title-card
        title: Cameras
        subtitle: Stills Only · Tap for Live
        grid_options:
          columns: full

      # Doorbell Camera
      - type: picture-entity
        entity: camera.doorbell_camera
        name: Doorbell
        camera_view: auto
        tap_action:
          action: more-info

      # Driveway Camera
      - type: picture-entity
        entity: camera.driveway_camera
        name: Driveway
        camera_view: auto
        tap_action:
          action: more-info

      # Pop-up cards
      - type: vertical-stack
        cards:

          # Climate Pop-up
          - type: custom:button-card
            name: Climate
            icon: mdi:thermostat
            show_name: false
            tap_action:
              action: fire-dom-event
              browser_mod:
                service: browser_mod.popup
                data:
                  title: Climate
                  content:
                    type: grid
                    columns: 2
                    square: false
                    cards:

                      # Climate and Humidity Cards
                      - type: custom:decluttering-card
                        template: climate_card
                        variables:
                          - entity: climate.downstairs_thermostat
                          - name: Downstairs
                      - type: custom:decluttering-card
                        template: climate_card
                        variables:
                          - entity: climate.upstairs_thermostat
                          - name: Upstairs
                      - type: custom:decluttering-card
                        template: climate_card
                        variables:
                          - entity: climate.playroom_minisplit_setall_playroom_minisplit
                          - name: Playroom
                      - type: custom:decluttering-card
                        template: climate_card
                        variables:
                          - entity: climate.gym_minisplit_setall_gym_minisplit
                          - name: Gym
                      - type: custom:decluttering-card
                        template: climate_card
                        variables:
                          - entity: climate.chicken_heat_lamp
                          - name: Chicken Coop
                      - type: custom:decluttering-card
                        template: climate_card
                        variables:
                          - entity: climate.study_space_heater
                          - name: Study Space Heater
                      - type: custom:decluttering-card
                        template: humidifier_card
                        variables:
                          - entity: humidifier.living_room_dehumidifier
                          - name: Living Room Dehumidifier
                      - type: custom:decluttering-card
                        template: humidifier_card
                        variables:
                          - entity: humidifier.dehumidifier
                          - name: Basement Dehumidifier
                      - type: custom:decluttering-card
                        template: humidifier_card
                        variables:
                          - entity: humidifier.humidifier
                          - name: Parlor Humidifier

                      # Climate States
                      - type: custom:decluttering-card
                        template: template_card
                        variables:
                          - entity: binary_sensor.sunny
                          - app: sunny
                      - type: custom:decluttering-card
                        template: template_card
                        variables:
                          - entity: binary_sensor.rainy
                          - app: rainy
                      - type: custom:decluttering-card
                        template: template_card
                        variables:
                          - entity: binary_sensor.dark_outside
                          - app: dark_outside
                      - type: custom:decluttering-card
                        template: template_card
                        variables:
                          - entity: binary_sensor.hot_inside
                          - app: hot_inside

            styles:
              card:
                - position: fixed
                - right: 24px
                - bottom: calc(env(safe-area-inset-bottom, 0px) + 16px)
                - z-index: 1099
                - width: 56px
                - height: 56px
                - aspect-ratio: 1 / 1
                - box-sizing: border-box
                - padding: 0
                - border-radius: 50%
                - box-shadow: 0 6px 20px rgba(0,0,0,.25)
                - background: var(--secondary-background-color)
                - color: var(--primary-text-color)
                - transition: opacity .25s ease, transform .25s ease
              icon:
                - width: 24px
                - height: 24px
                - transform: none !important
              img_cell:
                - background: none

          # Exterior Lights Pop-up
          - type: custom:button-card
            name: Exterior
            icon: mdi:lightbulb-on
            show_name: false
            tap_action:
              action: fire-dom-event
              browser_mod:
                service: browser_mod.popup
                data:
                  title: Exterior Lights
                  content:
                    - type: grid
                      columns: 2
                      square: false
                      cards:
                        - type: custom:mushroom-light-card
                          entity: light.front_porch_light
                          tap_action:
                            action: more-info
                        - type: custom:mushroom-light-card
                          entity: light.kitchen_porch_light
                          tap_action:
                            action: more-info
                        - type: custom:mushroom-light-card
                          entity: light.garage_lights
                          tap_action:
                            action: more-info
                        - type: custom:mushroom-light-card
                          entity: light.back_porch_lights
                          tap_action:
                            action: more-info
            styles:
              card:
                - position: fixed
                - right: 24px
                - bottom: calc(env(safe-area-inset-bottom, 0px) + 80px)
                - z-index: 1099
                - width: 56px
                - height: 56px
                - aspect-ratio: 1 / 1
                - box-sizing: border-box
                - padding: 0
                - border-radius: 50%
                - box-shadow: 0 6px 20px rgba(0,0,0,.25)
                - background: var(--secondary-background-color)
                - color: var(--primary-text-color)
                - transition: opacity .25s ease, transform .25s ease
              icon:
                - width: 24px
                - height: 24px
                - transform: none !important
              img_cell:
                - background: none

          # Blinds Pop-up
          - type: custom:button-card
            name: Blinds
            icon: mdi:blinds
            show_name: false
            tap_action:
              action: fire-dom-event
              browser_mod:
                service: browser_mod.popup
                data:
                  title: Blinds
                  content:
                    type: vertical-stack
                    cards:

                      # Closed for Brightness
                      - type: heading
                        icon: mdi:white-balance-sunny
                        heading: Closed for Brightness
                        heading_style: subtitle
                        visibility:
                          - condition: state
                            entity: group.closed_brightness
                            state: 'on'
                      - type: custom:auto-entities
                        card:
                          type: grid
                          columns: 2
                          square: false
                        card_param: cards
                        show_empty: false
                        filter:
                          template: >-
                            {% from 'macros/pop_up_blinds.jinja' import build_blind_cards %}
                            {{ build_blind_cards('brightness') | from_json }}

                      # Closed for Temperature
                      - type: heading
                        icon: mdi:thermometer-high
                        heading: Closed for Temperature
                        heading_style: subtitle
                        visibility:
                          - condition: state
                            entity: group.closed_temperature
                            state: 'on'
                      - type: custom:auto-entities
                        card:
                          type: grid
                          columns: 2
                          square: false
                        card_param: cards
                        show_empty: false
                        filter:
                          template: >-
                            {% from 'macros/pop_up_blinds.jinja' import build_blind_cards %}
                            {{ build_blind_cards('temperature') | from_json }}

                      # Closed for Presence
                      - type: heading
                        icon: mdi:motion-sensor
                        heading: Closed for Presence
                        heading_style: subtitle
                        visibility:
                          - condition: state
                            entity: group.closed_presence
                            state: 'on'
                      - type: custom:auto-entities
                        card:
                          type: grid
                          columns: 2
                          square: false
                        card_param: cards
                        show_empty: false
                        filter:
                          template: >-
                            {% from 'macros/pop_up_blinds.jinja' import build_blind_cards %}
                            {{ build_blind_cards('presence') | from_json }}

                      # Closed for Devices
                      - type: heading
                        icon: mdi:television
                        heading: Closed for Devices
                        heading_style: subtitle
                        visibility:
                          - condition: state
                            entity: group.closed_devices
                            state: 'on'
                      - type: custom:auto-entities
                        card:
                          type: grid
                          columns: 2
                          square: false
                        card_param: cards
                        show_empty: false
                        filter:
                          template: >-
                            {% from 'macros/pop_up_blinds.jinja' import build_blind_cards %}
                            {{ build_blind_cards('device') | from_json }}

                      # Closed by Button
                      - type: heading
                        icon: mdi:gesture-tap-button
                        heading: Closed by Button
                        heading_style: subtitle
                        visibility:
                          - condition: state
                            entity: group.closed_button
                            state: 'on'
                      - type: custom:auto-entities
                        card:
                          type: grid
                          columns: 2
                          square: false
                        card_param: cards
                        show_empty: false
                        filter:
                          template: >-
                            {% from 'macros/pop_up_blinds.jinja' import build_blind_cards %}
                            {{ build_blind_cards('button') | from_json }}

                      # Closed by Nighttime
                      - type: heading
                        icon: mdi:gesture-tap-button
                        heading: Closed by Nighttime
                        heading_style: subtitle
                        visibility:
                          - condition: state
                            entity: input_boolean.all_windows
                            state: 'off'
                      - type: custom:auto-entities
                        card:
                          type: grid
                          columns: 2
                          square: false
                        card_param: cards
                        show_empty: false
                        filter:
                          template: >-
                            {% from 'macros/pop_up_blinds.jinja' import build_blind_cards %}
                            {{ build_blind_cards('nighttime') | from_json }}
            styles:
              card:
                - position: fixed
                - right: 24px
                - bottom: calc(env(safe-area-inset-bottom, 0px) + 144px)
                - z-index: 1099
                - width: 56px
                - height: 56px
                - aspect-ratio: 1 / 1
                - box-sizing: border-box
                - padding: 0
                - border-radius: 50%
                - box-shadow: 0 6px 20px rgba(0,0,0,.25)
                - background: var(--secondary-background-color)
                - color: var(--primary-text-color)
                - transition: opacity .25s ease, transform .25s ease
              icon:
                - width: 24px
                - height: 24px
                - transform: none !important
              img_cell:
                - background: none

          # Presence Pop-up
          - type: custom:button-card
            name: Presence
            icon: mdi:account-group
            show_name: false
            tap_action:
              action: fire-dom-event
              browser_mod:
                service: browser_mod.popup
                data:
                  title: Presence
                  content:
                    type: vertical-stack
                    cards:
                      - type: grid
                        columns: 2
                        square: false
                        cards:
                          - type: custom:mushroom-person-card
                            entity: person.aaron_watson
                          - type: custom:mushroom-person-card
                            entity: person.ashley_watson
                          - type: custom:mushroom-person-card
                            entity: person.eleanor_watson
                          - type: custom:mushroom-person-card
                            entity: person.michael_watson
                          - type: custom:decluttering-card
                            template: template_card
                            variables:
                             - entity: input_boolean.someone_is_home
                             - app: someone_home
                          - type: custom:decluttering-card
                            template: template_card
                            variables:
                              - entity: input_boolean.home_alone
                              - app: home_alone
                          - type: custom:decluttering-card
                            template: template_card
                            variables:
                             - entity: input_boolean.coming_home
                             - app: returning_home
                          - type: custom:decluttering-card
                            template: template_card
                            variables:
                             - entity: sensor.people_home_count
                             - app: presence_count

            styles:
              card:
                - position: fixed
                - right: 24px
                - bottom: calc(env(safe-area-inset-bottom, 0px) + 208px)
                - z-index: 1099
                - width: 56px
                - height: 56px
                - aspect-ratio: 1 / 1
                - box-sizing: border-box
                - padding: 0
                - border-radius: 50%
                - box-shadow: 0 6px 20px rgba(0,0,0,.25)
                - background: var(--secondary-background-color)
                - color: var(--primary-text-color)
                - transition: opacity .25s ease, transform .25s ease
              icon:
                - width: 24px
                - height: 24px
                - transform: none !important
              img_cell:
                - background: none
