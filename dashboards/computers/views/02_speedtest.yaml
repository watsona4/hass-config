title: Network Speed
path: network-speed
type: masonry
cards:
  - type: vertical-stack
    cards:
      - type: custom:mushroom-title-card
        title: Home Connection
        subtitle: Speed and reliability
      - type: horizontal-stack
        cards:
          - type: custom:mushroom-template-card
            entity: sensor.home_download_rate
            primary: >-
              {%- from 'units/base.jinja' import u_humanize_entity -%}
              {{- u_humanize_entity(entity) -}}
            secondary: Download Rate
            icon: mdi:download
            icon_color: green
            tap_action:
              action: more-info
          - type: custom:mushroom-template-card
            entity: sensor.home_upload_rate
            primary: >-
              {%- from 'units/base.jinja' import u_humanize_entity -%}
              {{- u_humanize_entity(entity) -}}
            secondary: Upload Rate
            icon: mdi:upload
            icon_color: blue
            tap_action:
              action: more-info
          - type: custom:mushroom-template-card
            entity: sensor.home_latency_p50
            primary: >-
              {%- from 'units/base.jinja' import u_humanize_entity -%}
              {{- u_humanize_entity(entity) -}}
            secondary: Avg Latency
            icon: mdi:timer-sand
            icon_color: orange
            tap_action:
              action: more-info
      - type: horizontal-stack
        cards:
          - type: custom:mushroom-template-card
            entity: sensor.home_jitter_max
            primary: >-
              {%- from 'units/base.jinja' import u_humanize_entity -%}
              {{- u_humanize_entity(entity) -}}
            secondary: Max Jitter
            icon: mdi:waves
            icon_color: teal
            tap_action:
              action: more-info
          - type: custom:mushroom-template-card
            entity: sensor.home_packet_loss_combined
            primary: >-
              {%- from 'units/base.jinja' import u_humanize_entity -%}
              {{- u_humanize_entity(entity) -}}
            secondary: Packet Loss
            icon: mdi:package-variant-closed-remove
            icon_color: red
            tap_action:
              action: more-info
          - type: custom:mushroom-template-card
            entity: sensor.home_ping_success_rate
            primary: >-
              {%- from 'units/base.jinja' import u_humanize_entity -%}
              {{- u_humanize_entity(entity) -}}
            secondary: Ping Success
            icon: mdi:check-network
            icon_color: green
            tap_action:
              action: more-info
      - type: horizontal-stack
        cards:
          - type: custom:mushroom-template-card
            entity: sensor.home_download_utilization
            primary: >-
              {%- from 'units/base.jinja' import u_humanize_entity -%}
              {{- u_humanize_entity(entity) -}}
            secondary: Downlink Usage
            icon: mdi:download-network
            icon_color: cyan
            tap_action:
              action: more-info
          - type: custom:mushroom-template-card
            entity: sensor.home_upload_utilization
            primary: >-
              {%- from 'units/base.jinja' import u_humanize_entity -%}
              {{- u_humanize_entity(entity) -}}
            secondary: Uplink Usage
            icon: mdi:upload-network
            icon_color: indigo
            tap_action:
              action: more-info
          - type: custom:mushroom-template-card
            entity: sensor.home_link_saturation
            primary: >-
              {%- from 'units/base.jinja' import u_humanize_entity -%}
              {{- u_humanize_entity(entity) -}}
            secondary: Saturation
            icon: mdi:swap-vertical-bold
            icon_color: amber
            tap_action:
              action: more-info
      - type: custom:apexcharts-card
        header:
          title: Home Throughput and Utilization
          show: true
        graph_span: 24h
        span:
          end: minute
        apex_config:
          legend:
            position: top
        series:
          - entity: sensor.home_download_rate
            name: Download Rate
            type: line
            yaxis_id: default
            stroke_width: 2
          - entity: sensor.home_upload_rate
            name: Upload Rate
            type: line
            yaxis_id: default
            stroke_width: 2
          - entity: input_number.home_down_capacity_mbps
            name: Down Capacity
            type: line
            yaxis_id: default
            stroke_width: 1
            curve: stepline
          - entity: input_number.home_up_capacity_mbps
            name: Up Capacity
            type: line
            yaxis_id: default
            stroke_width: 1
            curve: stepline
          - entity: sensor.home_download_utilization
            name: Down Utilization
            type: line
            yaxis_id: pct
            stroke_width: 1
          - entity: sensor.home_upload_utilization
            name: Up Utilization
            type: line
            yaxis_id: pct
            stroke_width: 1
        yaxis:
          - id: default
            min: 0
            decimals: 0
            apex_config:
              title:
                text: Data Rate (Mbps)
          - id: pct
            opposite: true
            min: 0
            max: 100
            decimals: 0
            apex_config:
              title:
                text: Utilization (%)
      - type: custom:apexcharts-card
        header:
          title: Home Reliability
          show: true
        graph_span: 24h
        span:
          end: minute
        apex_config:
          legend:
            position: top
        series:
          - entity: sensor.home_latency_p50
            name: Avg Latency
            type: line
            yaxis_id: ms
            stroke_width: 2
          - entity: sensor.home_latency_tcp
            name: TCP Latency
            type: line
            yaxis_id: ms
            stroke_width: 1
          - entity: sensor.home_latency_icmp
            name: ICMP Latency
            type: line
            yaxis_id: ms
            stroke_width: 1
          - entity: sensor.home_jitter_ul
            name: Jitter UL
            type: line
            yaxis_id: ms
            stroke_width: 1
          - entity: sensor.home_jitter_dl
            name: Jitter DL
            type: line
            yaxis_id: ms
            stroke_width: 1
          - entity: sensor.home_packet_loss_ul
            name: Loss UL
            type: line
            yaxis_id: pct
            stroke_width: 1
          - entity: sensor.home_packet_loss_dl
            name: Loss DL
            type: line
            yaxis_id: pct
            stroke_width: 1
          - entity: sensor.home_packet_loss_combined
            name: Loss combined
            type: line
            yaxis_id: pct
            stroke_width: 2
          - entity: sensor.home_ping_success_rate
            name: Success %
            type: line
            yaxis_id: pct
            stroke_width: 2
        yaxis:
          - id: ms
            apex_config:
              title:
                text: Duration (ms)
            min: 0
            decimals: 0
          - id: pct
            opposite: true
            min: 0
            max: 100
            decimals: 0
            apex_config:
              title:
                text: Stability (%)
      - type: entities
        title: Home Test Details
        entities:
          - entity: sensor.home_udp_bitrate_target
            name: UDP bitrate target
          - entity: sensor.home_tcp_icmp_latency_delta
            name: TCP minus ICMP delta
          - entity: sensor.home_packets_ul
            name: Packets UL
          - entity: sensor.home_packets_dl
            name: Packets DL
          - entity: sensor.home_hiccup
            name: Hiccup
          - entity: sensor.home_hiccup_reason
            name: Hiccup reason
          - entity: sensor.home_speedtest_error_code
            name: Error code
          - entity: sensor.home_download_mode
            name: Download mode
          - entity: sensor.home_upload_mode
            name: Upload mode
          - entity: input_number.home_down_capacity_mbps
            name: Down capacity
          - entity: input_number.home_up_capacity_mbps
            name: Up capacity
  - type: vertical-stack
    cards:
      - type: custom:mushroom-title-card
        title: RV Connection
        subtitle: Speed and reliability
      - type: horizontal-stack
        cards:
          - type: custom:mushroom-template-card
            entity: sensor.rv_download_rate
            primary: >-
              {%- from 'units/base.jinja' import u_humanize_entity -%}
              {{- u_humanize_entity(entity) -}}
            secondary: Download Rate
            icon: mdi:download
            icon_color: green
            tap_action:
              action: more-info
          - type: custom:mushroom-template-card
            entity: sensor.rv_upload_rate
            primary: >-
              {%- from 'units/base.jinja' import u_humanize_entity -%}
              {{- u_humanize_entity(entity) -}}
            secondary: Upload Rate
            icon: mdi:upload
            icon_color: blue
            tap_action:
              action: more-info
          - type: custom:mushroom-template-card
            entity: sensor.rv_latency_p50
            primary: >-
              {%- from 'units/base.jinja' import u_humanize_entity -%}
              {{- u_humanize_entity(entity) -}}
            secondary: Avg Latency
            icon: mdi:timer-sand
            icon_color: orange
            tap_action:
              action: more-info
      - type: horizontal-stack
        cards:
          - type: custom:mushroom-template-card
            entity: sensor.rv_jitter_max
            primary: >-
              {%- from 'units/base.jinja' import u_humanize_entity -%}
              {{- u_humanize_entity(entity) -}}
            secondary: Max Jitter
            icon: mdi:waves
            icon_color: teal
            tap_action:
              action: more-info
          - type: custom:mushroom-template-card
            entity: sensor.rv_packet_loss_combined
            primary: >-
              {%- from 'units/base.jinja' import u_humanize_entity -%}
              {{- u_humanize_entity(entity) -}}
            secondary: Packet Loss
            icon: mdi:package-variant-closed-remove
            icon_color: red
            tap_action:
              action: more-info
          - type: custom:mushroom-template-card
            entity: sensor.rv_ping_success_rate
            primary: >-
              {%- from 'units/base.jinja' import u_humanize_entity -%}
              {{- u_humanize_entity(entity) -}}
            secondary: Ping Success
            icon: mdi:check-network-outline
            icon_color: green
            tap_action:
              action: more-info
      - type: horizontal-stack
        cards:
          - type: custom:mushroom-template-card
            entity: sensor.rv_download_utilization
            primary: >-
              {%- from 'units/base.jinja' import u_humanize_entity -%}
              {{- u_humanize_entity(entity) -}}
            secondary: Down Utilization
            icon: mdi:download-network-outline
            icon_color: cyan
            tap_action:
              action: more-info
          - type: custom:mushroom-template-card
            entity: sensor.rv_upload_utilization
            primary: >-
              {%- from 'units/base.jinja' import u_humanize_entity -%}
              {{- u_humanize_entity(entity) -}}
            secondary: Up Utilization
            icon: mdi:upload-network-outline
            icon_color: indigo
            tap_action:
              action: more-info
          - type: custom:mushroom-template-card
            entity: sensor.rv_link_saturation
            primary: >-
              {%- from 'units/base.jinja' import u_humanize_entity -%}
              {{- u_humanize_entity(entity) -}}
            secondary: Saturation
            icon: mdi:swap-vertical
            icon_color: amber
            tap_action:
              action: more-info
      - type: custom:apexcharts-card
        header:
          title: RV Throughput and Utilization
          show: true
        graph_span: 24h
        span:
          end: minute
        apex_config:
          legend:
            position: top
        series:
          - entity: sensor.rv_download_rate
            name: Download Rate
            type: line
            yaxis_id: default
            stroke_width: 2
          - entity: sensor.rv_upload_rate
            name: Upload Rate
            type: line
            yaxis_id: default
            stroke_width: 2
          - entity: input_number.rv_down_capacity_mbps
            name: Down Capacity
            type: line
            yaxis_id: default
            stroke_width: 1
            curve: stepline
          - entity: input_number.rv_up_capacity_mbps
            name: Up Capacity
            type: line
            yaxis_id: default
            stroke_width: 1
            curve: stepline
          - entity: sensor.rv_download_utilization
            name: Down Utilization
            type: line
            yaxis_id: pct
            stroke_width: 1
          - entity: sensor.rv_upload_utilization
            name: Up Utilization
            type: line
            yaxis_id: pct
            stroke_width: 1
        yaxis:
          - id: default
            min: 0
            decimals: 0
            apex_config:
              title:
                text: Data Rate (Mbps)
          - id: pct
            opposite: true
            min: 0
            max: 100
            decimals: 0
            apex_config:
              title:
                text: Utilization (%)
      - type: custom:apexcharts-card
        header:
          title: RV Reliability
          show: true
        graph_span: 24h
        span:
          end: minute
        apex_config:
          legend:
            position: top
        series:
          - entity: sensor.rv_latency_p50
            name: Avg Latency
            type: line
            yaxis_id: ms
            stroke_width: 2
          - entity: sensor.rv_latency_tcp
            name: TCP latency
            type: line
            yaxis_id: ms
            stroke_width: 1
          - entity: sensor.rv_latency_icmp
            name: ICMP latency
            type: line
            yaxis_id: ms
            stroke_width: 1
          - entity: sensor.rv_jitter_ul
            name: Jitter UL
            type: line
            yaxis_id: ms
            stroke_width: 1
          - entity: sensor.rv_jitter_dl
            name: Jitter DL
            type: line
            yaxis_id: ms
            stroke_width: 1
          - entity: sensor.rv_packet_loss_ul
            name: Loss UL
            type: line
            yaxis_id: pct
            stroke_width: 1
          - entity: sensor.rv_packet_loss_dl
            name: Loss DL
            type: line
            yaxis_id: pct
            stroke_width: 1
          - entity: sensor.rv_packet_loss_combined
            name: Loss combined
            type: line
            yaxis_id: pct
            stroke_width: 2
          - entity: sensor.rv_ping_success_rate
            name: Success %
            type: line
            yaxis_id: pct
            stroke_width: 2
        yaxis:
          - id: ms
            apex_config:
              title:
                text: Duration (ms)
            min: 0
            decimals: 0
          - id: pct
            opposite: true
            min: 0
            max: 100
            decimals: 0
            apex_config:
              title:
                text: Stability (%)
      - type: entities
        title: RV Test Details
        entities:
          - entity: sensor.rv_udp_bitrate_target
            name: UDP bitrate target
          - entity: sensor.rv_tcp_icmp_latency_delta
            name: TCP minus ICMP delta
          - entity: sensor.rv_packets_ul
            name: Packets UL
          - entity: sensor.rv_packets_dl
            name: Packets DL
          - entity: sensor.rv_hiccup
            name: Hiccup
          - entity: sensor.rv_hiccup_reason
            name: Hiccup reason
          - entity: sensor.rv_speedtest_error_code
            name: Error code
          - entity: sensor.rv_download_mode
            name: Download mode
          - entity: sensor.rv_upload_mode
            name: Upload mode
          - entity: input_number.rv_down_capacity_mbps
            name: Down capacity
          - entity: input_number.rv_up_capacity_mbps
            name: Up capacity
  - type: vertical-stack
    cards:
      - type: custom:mushroom-title-card
        title: Home vs RV
        subtitle: Quick comparison
      - type: custom:apexcharts-card
        header:
          title: Download and Upload
          show: true
        graph_span: 24h
        span:
          end: minute
        apex_config:
          legend:
            position: top
        series:
          - entity: sensor.home_download_rate
            name: Home Download Rate
            type: line
            stroke_width: 2
          - entity: sensor.rv_download_rate
            name: RV Download Rate
            type: line
            stroke_width: 2
          - entity: sensor.home_upload_rate
            name: Home Upload Rate
            type: line
            stroke_width: 1
          - entity: sensor.rv_upload_rate
            name: RV Upload Rate
            type: line
            stroke_width: 1
        yaxis:
          - apex_config:
              title:
                text: Data Rate (Mbps)
            min: 0
      - type: custom:apexcharts-card
        header:
          title: Latency and Loss
          show: true
        graph_span: 24h
        span:
          end: minute
        apex_config:
          legend:
            position: top
        series:
          - entity: sensor.home_latency_p50
            name: Home Avg Latency
            type: line
            yaxis_id: ms
            stroke_width: 2
          - entity: sensor.rv_latency_p50
            name: RV Avg Latency
            type: line
            yaxis_id: ms
            stroke_width: 2
          - entity: sensor.home_packet_loss_combined
            name: Home Loss Rate
            type: line
            yaxis_id: pct
            stroke_width: 1
          - entity: sensor.rv_packet_loss_combined
            name: RV Loss Rate
            type: line
            yaxis_id: pct
            stroke_width: 1
        yaxis:
          - id: ms
            min: 0
            apex_config:
              title:
                text: Duration (ms)
          - id: pct
            opposite: true
            min: 0
            max: 100
            apex_config:
              title:
                text: Stability (%)
