- binary_sensor:
    - name: Laptop Status Alarm
      device_class: problem
      availability: "{{ has_value('binary_sensor.laptop_oo58t6kn_overall_status_ok') }}"
      state: "{{ is_state('binary_sensor.laptop_oo58t6kn_overall_status_ok','off') }}"
    - name: Desktop Status Alarm
      device_class: problem
      availability: "{{ has_value('binary_sensor.desktop_bq063ig_overall_status_ok') }}"
      state: "{{ is_state('binary_sensor.desktop_bq063ig_overall_status_ok','off') }}"
    - name: Frigate Status Alarm
      device_class: problem
      availability: "{{ has_value('binary_sensor.frigate_overall_status_ok') }}"
      state: "{{ is_state('binary_sensor.frigate_overall_status_ok','off') }}"
    - name: OPNSense Status Alarm
      device_class: problem
      availability: "{{ has_value('binary_sensor.opnsense_overall_status_ok') }}"
      state: "{{ is_state('binary_sensor.opnsense_overall_status_ok','off') }}"

- binary_sensor:
    - name: Laptop Display Containers
      state: "{{ false }}"
    - name: Desktop Display Containers
      state: "{{ false }}"
    - name: Frigate Display Containers
      state: >
        {% set entities = states.binary_sensor | selectattr("entity_id", "match", "^binary_sensor\.frigate.*_container_.*$") %}
        {{ entities | selectattr('state','eq','off') | list | count > 0 }}
    - name: OPNSense Display Containers
      state: "{{ false }}"

- binary_sensor:
    - name: Laptop Display Services
      state: >
        {% set entities = states.binary_sensor | selectattr("entity_id", "match", "^binary_sensor\.laptop_oo58t6kn.*_service_.*$") %}
        {{ entities | selectattr('state','eq','off') | list | count > 0 }}
    - name: Desktop Display Services
      state: >
        {% set entities = states.binary_sensor | selectattr("entity_id", "match", "^binary_sensor\.desktop_bq063ig.*_service_.*$") %}
        {{ entities | selectattr('state','eq','off') | list | count > 0 }}
    - name: Frigate Display Services
      state: >
        {% set entities = states.binary_sensor | selectattr("entity_id", "match", "^binary_sensor\.frigate.*_service_.*$") %}
        {{ entities | selectattr('state','eq','off') | list | count > 0 }}
    - name: OPNSense Display Services
      state: >
        {% set entities = states.binary_sensor | selectattr("entity_id", "match", "^binary_sensor\.opnsense.*_service_.*$") %}
        {{ entities | selectattr('state','eq','off') | list | count > 0 }}

- sensor:
    - name: Laptop PhysicalDrive0 Data Rate
      availability: "{{ has_value('sensor.laptop_oo58t6kn_disk_physicaldrive0_read_rate') or has_value('sensor.laptop_oo58t6kn_disk_physicaldrive0_write_rate') }}"
      state: "{{ states('sensor.laptop_oo58t6kn_disk_physicaldrive0_read_rate')|float(0) + states('sensor.laptop_oo58t6kn_disk_physicaldrive0_write_rate')|float(0) }}"
      unit_of_measurement: B/s
      device_class: data_rate
      state_class: measurement
    - name: Desktop PhysicalDrive0 Data Rate
      availability: "{{ has_value('sensor.desktop_bq063ig_disk_physicaldrive0_read_rate') or has_value('sensor.desktop_bq063ig_disk_physicaldrive0_write_rate') }}"
      state: "{{ states('sensor.desktop_bq063ig_disk_physicaldrive0_read_rate')|float(0) + states('sensor.desktop_bq063ig_disk_physicaldrive0_write_rate')|float(0) }}"
      unit_of_measurement: B/s
      device_class: data_rate
      state_class: measurement
    - name: Desktop PhysicalDrive1 Data Rate
      availability: "{{ has_value('sensor.desktop_bq063ig_disk_physicaldrive1_read_rate') or has_value('sensor.desktop_bq063ig_disk_physicaldrive1_write_rate') }}"
      state: "{{ states('sensor.desktop_bq063ig_disk_physicaldrive1_read_rate')|float(0) + states('sensor.desktop_bq063ig_disk_physicaldrive1_write_rate')|float(0) }}"
      unit_of_measurement: B/s
      device_class: data_rate
      state_class: measurement
    - name: Desktop PhysicalDrive2 Data Rate
      availability: "{{ has_value('sensor.desktop_bq063ig_disk_physicaldrive2_read_rate') or has_value('sensor.desktop_bq063ig_disk_physicaldrive2_write_rate') }}"
      state: "{{ states('sensor.desktop_bq063ig_disk_physicaldrive2_read_rate')|float(0) + states('sensor.desktop_bq063ig_disk_physicaldrive2_write_rate')|float(0) }}"
      unit_of_measurement: B/s
      device_class: data_rate
      state_class: measurement
    - name: Frigate nvme0n1 Data Rate
      availability: "{{ has_value('sensor.frigate_disk_nvme0n1_read_rate') or has_value('sensor.frigate_disk_nvme0n1_write_rate') }}"
      state: "{{ states('sensor.frigate_disk_nvme0n1_read_rate')|float(0) + states('sensor.frigate_disk_nvme0n1_write_rate')|float(0) }}"
      unit_of_measurement: B/s
      device_class: data_rate
      state_class: measurement
    - name: Frigate sda Data Rate
      availability: "{{ has_value('sensor.frigate_disk_sda_read_rate') or has_value('sensor.frigate_disk_sda_write_rate') }}"
      state: "{{ states('sensor.frigate_disk_sda_read_rate')|float(0) + states('sensor.frigate_disk_sda_write_rate')|float(0) }}"
      unit_of_measurement: B/s
      device_class: data_rate
      state_class: measurement
    - name: OPNSense ada0 Data Rate
      availability: "{{ has_value('sensor.opnsense_disk_ada0_read_rate') or has_value('sensor.opnsense_disk_ada0_write_rate') }}"
      state: "{{ states('sensor.opnsense_disk_ada0_read_rate')|float(0) + states('sensor.opnsense_disk_ada0_write_rate')|float(0) }}"
      unit_of_measurement: B/s
      device_class: data_rate
      state_class: measurement

- sensor:
    - name: Laptop Battery Charge
      availability: "{{ has_value('sensor.laptop_oo58t6kn_battery_percent') }}"
      state: "{{ states('sensor.laptop_oo58t6kn_battery_percent') }}"
      unit_of_measurement: '%'
      device_class: battery
      state_class: measurement